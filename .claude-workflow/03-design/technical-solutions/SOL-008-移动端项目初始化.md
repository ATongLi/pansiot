# SOL-008: 移动端项目初始化技术方案

## 元数据
- **方案ID**: SOL-008
- **关联功能**: FE-008
- **方案类型**: 架构 + 技术选型
- **状态**: 已批准
- **设计人**: Claude Code
- **评审人**: 待评审
- **创建日期**: 2026-01-28

## 背景和目标

### 业务背景
工业物联网平台需要移动端应用,支持设备管理、工程管理、消息推送等核心功能。移动端作为云平台和网关的延伸,为用户提供随时随地的监控和管理能力。

### 核心目标
1. **建立标准化架构**: 搭建基于 UniApp 的模块化、组件化架构
2. **快速原型验证**: 实现第一个可运行页面,验证技术方案可行性
3. **工程化基础**: 建立完整的开发规范和工程化配置
4. **可扩展性**: 为后续功能开发提供清晰的架构基础

### 非功能需求
- **性能**: 页面首屏加载 < 2秒,应用启动 < 3秒
- **兼容性**: 支持 iOS 12+, Android 7+, 微信小程序
- **可维护性**: 模块化架构,代码复用率 > 80%
- **安全性**: HTTPS, Token认证,敏感数据加密

## 问题陈述

需要为工业物联网移动端应用创建:
1. **清晰的目录结构**: 支持模块化开发
2. **模块化架构**: 6个核心业务模块独立开发
3. **基础页面框架**: TabBar导航、路由配置、生命周期管理
4. **通用组件库**: 提高代码复用率
5. **第一个可运行页面**: 验证架构可行性

## 方案概述

采用 **UniApp + Vue 3 + TypeScript + Pinia** 技术栈,实现模块化移动端架构。核心设计包括:
- **分层架构**: Presentation(展示层) / Business(业务层) / Data(数据层)
- **模块化设计**: 6个业务模块独立开发,降低耦合
- **组件化开发**: 通用组件库提高复用率
- **工程化配置**: TypeScript + ESLint + Prettier 确保代码质量
- **依赖忽略机制**: 使用 Mock 实现与云平台 API 解耦

## 技术选型

| 技术领域 | 选型方案 | 理由 | 替代方案 | 对比分析 |
|---------|---------|------|---------|---------|
| **前端框架** | UniApp (Vue 3 + TS) | 跨平台(iOS/Android/小程序),社区活跃,生态完善 | React Native / Flutter | UniApp 一次开发多端运行,更适合快速迭代;RN/Flutter 性能更好但学习成本高 |
| **状态管理** | Pinia | Vue 3 官方推荐,TypeScript 友好,API 简洁 | Vuex | Pinia 更轻量,类型推断更好,不再需要 mutations |
| **UI 组件库** | UniUI | 官方组件库,与 UniApp 深度集成,多端兼容 | uView Plus / NutUI | UniUI 更稳定;uView 功能更丰富但可能存在兼容性问题 |
| **HTTP 客户端** | Uni.request 封装 | UniApp 内置,多端兼容性好 | Axios | Axios 功能更强但需要适配小程序,Uni.request 足够使用 |
| **构建工具** | Vite | 快速热更新,开发体验好 | Webpack | Vite 速度更快,配置更简单 |
| **代码规范** | ESLint + Prettier | 业界标准,VSCode 深度集成 | TSLint | TSLint 已废弃,ESLint 更强大 |
| **TypeScript** | Strict 模式 | 类型安全,减少运行时错误 | JavaScript | TS 提供类型检查,提升代码质量和可维护性 |

### 架构决策记录 (ADR)

详见后续章节:

1. **ADR-001**: 选择 UniApp 作为跨平台框架
2. **ADR-002**: 选择 Pinia 作为状态管理方案
3. **ADR-003**: 采用模块化分层架构

## 架构设计

### 系统架构图

```
┌─────────────────────────────────────────────────────────────┐
│                      Presentation Layer                     │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐      │
│  │    Pages     │  │  Components  │  │     App      │      │
│  │  (页面层)     │  │  (组件层)     │  │  (应用入口)   │      │
│  └──────────────┘  └──────────────┘  └──────────────┘      │
└─────────────────────────────────────────────────────────────┘
                            ↓↑
┌─────────────────────────────────────────────────────────────┐
│                      Business Layer                         │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐      │
│  │    Stores    │  │   Composables│  │  Services    │      │
│  │  (状态管理)   │  │  (组合式函数) │  │  (业务服务)   │      │
│  └──────────────┘  └──────────────┘  └──────────────┘      │
└─────────────────────────────────────────────────────────────┘
                            ↓↑
┌─────────────────────────────────────────────────────────────┐
│                       Data Layer                            │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐      │
│  │     API      │  │    Utils     │  │    Types     │      │
│  │  (API封装)   │  │  (工具类)     │  │  (类型定义)   │      │
│  └──────────────┘  └──────────────┘  └──────────────┘      │
└─────────────────────────────────────────────────────────────┘
                            ↓↑
┌─────────────────────────────────────────────────────────────┐
│                    External Services                        │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐      │
│  │ Cloud API    │  │ Local Storage│  │   Uni API    │      │
│  │ (云平台接口)  │  │  (本地存储)   │  │ (UniApp接口) │      │
│  └──────────────┘  └──────────────┘  └──────────────┘      │
└─────────────────────────────────────────────────────────────┘
```

### 目录结构设计

```
pansiot-app/
├── src/
│   ├── api/                    # Data Layer - API封装
│   │   ├── index.ts
│   │   ├── auth.ts            # 认证相关API
│   │   ├── device.ts          # 设备相关API
│   │   ├── workspace.ts       # 工作台相关API
│   │   ├── dashboard.ts       # 看板相关API
│   │   ├── message.ts         # 消息相关API
│   │   └── profile.ts         # 个人中心相关API
│   │
│   ├── components/             # Presentation Layer - 通用组件
│   │   ├── common/            # 通用基础组件
│   │   │   ├── CustomNavBar/      # 自定义导航栏
│   │   │   ├── PageContainer/     # 页面容器
│   │   │   ├── Loading/           # 加载指示器
│   │   │   ├── EmptyState/        # 空状态
│   │   │   ├── NetworkError/      # 网络异常
│   │   │   ├── PullRefresh/       # 下拉刷新
│   │   │   └── LoadMore/          # 上拉加载
│   │   └── business/         # 业务组件(按模块组织)
│   │       ├── auth/              # 登录模块组件
│   │       ├── device/            # 设备模块组件
│   │       └── ...
│   │
│   ├── pages/                  # Presentation Layer - 页面
│   │   ├── index/             # 启动页/欢迎页
│   │   │   └── index.vue
│   │   ├── auth/              # 登录模块
│   │   │   ├── login/         # 登录页
│   │   │   └── register/      # 注册页
│   │   ├── device/            # 设备模块
│   │   │   ├── list/          # 设备列表
│   │   │   └── detail/        # 设备详情
│   │   ├── workspace/         # 工作台模块
│   │   ├── dashboard/         # 看板模块
│   │   ├── message/           # 消息模块
│   │   └── profile/           # 我的模块
│   │       ├── center/        # 个人中心
│   │       └── settings/      # 设置
│   │
│   ├── stores/                # Business Layer - 状态管理
│   │   ├── index.ts
│   │   ├── auth.ts            # 认证状态
│   │   ├── device.ts          # 设备状态
│   │   ├── workspace.ts       # 工作台状态
│   │   ├── dashboard.ts       # 看板状态
│   │   ├── message.ts         # 消息状态
│   │   ├── profile.ts         # 个人中心状态
│   │   └── app.ts             # 应用全局状态
│   │
│   ├── composables/           # Business Layer - 组合式函数
│   │   ├── useAuth.ts         # 认证相关逻辑
│   │   ├── useDevice.ts       # 设备相关逻辑
│   │   ├── useRequest.ts      # 网络请求封装
│   │   └── usePagination.ts   # 分页逻辑
│   │
│   ├── utils/                 # Data Layer - 工具类
│   │   ├── request.ts         # HTTP请求封装
│   │   ├── storage.ts         # 本地存储封装
│   │   ├── validator.ts       # 表单验证
│   │   ├── format.ts          # 格式化工具
│   │   ├── date.ts            # 日期工具
│   │   └── constants.ts       # 常量定义
│   │
│   ├── types/                 # Data Layer - TypeScript类型定义
│   │   ├── api.d.ts           # API响应类型
│   │   ├── auth.d.ts          # 认证相关类型
│   │   ├── device.d.ts        # 设备相关类型
│   │   ├── workspace.d.ts     # 工作台相关类型
│   │   ├── dashboard.d.ts     # 看板相关类型
│   │   ├── message.d.ts       # 消息相关类型
│   │   ├── profile.d.ts       # 个人中心相关类型
│   │   └── common.d.ts        # 通用类型
│   │
│   ├── styles/                # 全局样式
│   │   ├── index.scss         # 样式入口
│   │   ├── variables.scss     # SCSS变量(主题色、间距等)
│   │   ├── mixins.scss        # SCSS混入
│   │   └── reset.scss         # 样式重置
│   │
│   ├── static/                # 静态资源
│   │   ├── images/            # 图片
│   │   ├── icons/             # 图标
│   │   └── fonts/             # 字体
│   │
│   ├── App.vue                # 应用入口组件
│   ├── main.ts                # 应用入口文件
│   ├── manifest.json          # UniApp应用配置
│   ├── pages.json             # 页面路由配置
│   └── uni.scss               # UniApp内置样式变量
│
├── .env.development           # 开发环境变量
├── .env.production            # 生产环境变量
├── .eslintrc.js               # ESLint配置
├── .prettierrc                # Prettier配置
├── tsconfig.json              # TypeScript配置
├── vite.config.ts             # Vite配置
└── package.json               # 项目依赖
```

### 组件设计

| 组件名 | 职责 | 依赖 | 接口 | 技术栈 |
|--------|------|------|------|--------|
| **CustomNavBar** | 自定义导航栏,支持标题、返回、右侧操作 | Uni UI navigation-bar | title, backgroundColor, showBack | Vue 3 + TypeScript |
| **PageContainer** | 页面容器,提供统一布局和样式 | - | backgroundColor, padding, showLoading | Vue 3 + SCSS |
| **Loading** | 加载指示器,支持多种加载样式 | Uni UI loading | type, size, color, text | Uni UI |
| **EmptyState** | 空状态提示,支持自定义图标和文字 | Uni UI empty | image, text, description | Uni UI |
| **NetworkError** | 网络异常提示,支持重试 | - | onRetry | Vue 3 + SCSS |
| **PullRefresh** | 下拉刷新容器 | Uni UI scroll-view | onRefresh, disabled | Uni UI |
| **LoadMore** | 上拉加载更多 | Uni UI load-more | onLoadMore, hasMore, loading | Uni UI |

### 模块设计

#### 1. Auth 模块 (登录模块)
**职责**: 用户认证、登录、注册、登出

**组件**:
- `pages/auth/login/index.vue` - 登录页
- `pages/auth/register/index.vue` - 注册页
- `components/business/auth/LoginForm.vue` - 登录表单
- `components/business/auth/RegisterForm.vue` - 注册表单

**状态管理**: `stores/auth.ts`
```typescript
interface AuthState {
  token: string | null
  userInfo: UserInfo | null
  isLoggedIn: boolean
}
```

**服务层**: `api/auth.ts`
- `login(username, password)` - 登录
- `logout()` - 登出
- `register(data)` - 注册
- `getUserInfo()` - 获取用户信息

#### 2. Device 模块 (设备模块)
**职责**: 设备列表、设备详情、设备控制

**组件**:
- `pages/device/list/index.vue` - 设备列表
- `pages/device/detail/index.vue` - 设备详情
- `components/business/device/DeviceCard.vue` - 设备卡片
- `components/business/device/DeviceControl.vue` - 设备控制面板

**状态管理**: `stores/device.ts`
```typescript
interface DeviceState {
  devices: Device[]
  currentDevice: Device | null
  deviceStatus: Record<string, DeviceStatus>
}
```

**服务层**: `api/device.ts`
- `getDeviceList(params)` - 获取设备列表
- `getDeviceDetail(id)` - 获取设备详情
- `controlDevice(id, command)` - 控制设备

#### 3. Workspace 模块 (工作台模块)
**职责**: 快捷操作、待办事项、常用功能入口

**组件**:
- `pages/workspace/index.vue` - 工作台主页
- `components/business/workspace/QuickActions.vue` - 快捷操作
- `components/business/workspace/ToDoList.vue` - 待办事项

**状态管理**: `stores/workspace.ts`
```typescript
interface WorkspaceState {
  quickActions: QuickAction[]
  todoList: TodoItem[]
  notifications: Notification[]
}
```

**服务层**: `api/workspace.ts`
- `getQuickActions()` - 获取快捷操作
- `getTodoList()` - 获取待办事项

#### 4. Dashboard 模块 (看板模块)
**职责**: 数据可视化、图表展示、实时监控

**组件**:
- `pages/dashboard/index.vue` - 看板主页
- `components/business/dashboard/ChartCard.vue` - 图表卡片
- `components/business/dashboard/RealTimeData.vue` - 实时数据

**状态管理**: `stores/dashboard.ts`
```typescript
interface DashboardState {
  charts: ChartData[]
  realTimeData: RealTimeData[]
}
```

**服务层**: `api/dashboard.ts`
- `getChartData()` - 获取图表数据
- `getRealTimeData()` - 获取实时数据

#### 5. Message 模块 (消息模块)
**职责**: 消息列表、消息详情、消息推送

**组件**:
- `pages/message/list/index.vue` - 消息列表
- `pages/message/detail/index.vue` - 消息详情
- `components/business/message/MessageCard.vue` - 消息卡片

**状态管理**: `stores/message.ts`
```typescript
interface MessageState {
  messages: Message[]
  unreadCount: number
}
```

**服务层**: `api/message.ts`
- `getMessageList(params)` - 获取消息列表
- `getMessageDetail(id)` - 获取消息详情
- `markAsRead(id)` - 标记已读

#### 6. Profile 模块 (我的模块)
**职责**: 个人中心、设置、企业信息

**组件**:
- `pages/profile/center/index.vue` - 个人中心
- `pages/profile/settings/index.vue` - 设置
- `components/business/profile/UserInfo.vue` - 用户信息
- `components/business/profile/SettingItem.vue` - 设置项

**状态管理**: `stores/profile.ts`
```typescript
interface ProfileState {
  userInfo: UserInfo
  settings: UserSettings
}
```

**服务层**: `api/profile.ts`
- `getUserInfo()` - 获取用户信息
- `updateUserInfo(data)` - 更新用户信息
- `updateSettings(data)` - 更新设置

### 数据流

```
┌─────────────┐
│   User      │ 用户交互
└──────┬──────┘
       │
       ↓
┌─────────────────────────────────────┐
│         Pages (Vue Components)       │ 展示层
└──────┬──────────────────────────────┘
       │
       ↓ (调用 Composables)
┌─────────────────────────────────────┐
│        Composables (useAuth, etc)    │ 业务逻辑层
└──────┬──────────────────────────────┘
       │
       ├─────────────┬───────────────┐
       ↓             ↓               ↓
┌──────────┐  ┌──────────┐  ┌──────────┐
│  Stores  │  │  API     │  │  Utils   │ 数据层
│  (Pinia) │  │ (request)│  │          │
└──────────┘  └────┬─────┘  └──────────┘
                   │
                   ↓
            ┌──────────────┐
            │ Cloud API    │ 外部服务
            └──────────────┘
```

## 接口设计

### API 接口规范

#### 基础配置
**BaseURL**: 通过环境变量配置
```typescript
// .env.development
VITE_API_BASE_URL=https://dev-api.pansiot.com

// .env.production
VITE_API_BASE_URL=https://api.pansiot.com
```

**统一响应格式**:
```typescript
interface ApiResponse<T = any> {
  code: number        // 状态码: 200成功, 其他失败
  data: T             // 响应数据
  message: string     // 提示信息
  timestamp: number   // 时间戳
}
```

**错误处理**:
```typescript
interface ApiError {
  code: number
  message: string
  details?: any
}
```

#### 认证相关 API

##### 1. 用户登录
```
POST /api/auth/login
```

**请求参数**:
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| username | string | 是 | 用户名/手机号/邮箱 |
| password | string | 是 | 密码 |
| tenantId | string | 否 | 租户ID(多租户场景) |

**响应**:
```json
{
  "code": 200,
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "tokenType": "Bearer",
    "expiresIn": 7200,
    "refreshToken": "refresh_token_here",
    "userInfo": {
      "id": "user_123",
      "username": "admin",
      "realName": "管理员",
      "email": "admin@example.com",
      "phone": "13800138000",
      "avatar": "https://cdn.example.com/avatar.jpg",
      "roles": ["admin"],
      "tenant": {
        "id": "tenant_001",
        "name": "示例企业"
      }
    }
  },
  "message": "登录成功",
  "timestamp": 1706745600000
}
```

**错误响应**:
- `400`: 参数错误
- `401`: 用户名或密码错误
- `403`: 账户已被禁用
- `500`: 服务器错误

##### 2. 用户登出
```
POST /api/auth/logout
```

**请求头**:
```
Authorization: Bearer {token}
```

**响应**:
```json
{
  "code": 200,
  "data": null,
  "message": "登出成功",
  "timestamp": 1706745600000
}
```

##### 3. 获取用户信息
```
GET /api/auth/user-info
```

**请求头**:
```
Authorization: Bearer {token}
```

**响应**:
```json
{
  "code": 200,
  "data": {
    "id": "user_123",
    "username": "admin",
    "realName": "管理员",
    "email": "admin@example.com",
    "phone": "13800138000",
    "avatar": "https://cdn.example.com/avatar.jpg",
    "roles": ["admin"],
    "permissions": ["device:read", "device:write"],
    "tenant": {
      "id": "tenant_001",
      "name": "示例企业"
    }
  },
  "message": "success",
  "timestamp": 1706745600000
}
```

#### 设备相关 API

##### 1. 获取设备列表
```
GET /api/devices
```

**请求参数** (Query):
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| page | number | 否 | 页码,默认1 |
| pageSize | number | 否 | 每页数量,默认20 |
| status | string | 否 | 设备状态筛选 |
| keyword | string | 否 | 搜索关键词 |

**响应**:
```json
{
  "code": 200,
  "data": {
    "total": 100,
    "list": [
      {
        "id": "device_001",
        "name": "温度传感器01",
        "type": "sensor",
        "status": "online",
        "lastSeen": 1706745600000,
        "location": "车间A",
        "data": {
          "temperature": 25.5,
          "humidity": 60
        }
      }
    ]
  },
  "message": "success",
  "timestamp": 1706745600000
}
```

##### 2. 获取设备详情
```
GET /api/devices/{id}
```

**响应**:
```json
{
  "code": 200,
  "data": {
    "id": "device_001",
    "name": "温度传感器01",
    "type": "sensor",
    "status": "online",
    "location": "车间A",
    "description": "监测车间温度和湿度",
    "createdAt": 1706745600000,
    "properties": [
      {
        "name": "temperature",
        "value": 25.5,
        "unit": "℃",
        "timestamp": 1706745600000
      }
    ]
  },
  "message": "success",
  "timestamp": 1706745600000
}
```

### Mock 数据策略

由于弱依赖 FE-007 (云平台认证 API),在初始化阶段使用 Mock 数据:

**Mock 服务**: `utils/mock.ts`
```typescript
export const mockAuthLogin = (params: LoginParams): Promise<LoginResponse> => {
  return new Promise((resolve) => {
    setTimeout(() => {
      resolve({
        token: 'mock_token_' + Date.now(),
        expiresIn: 7200,
        userInfo: {
          id: 'mock_user_001',
          username: params.username,
          realName: '测试用户',
          avatar: ''
        }
      })
    }, 500) // 模拟网络延迟
  })
}
```

**依赖忽略标记**:
```typescript
// TODO(依赖): FE-007 - 云平台账号系统
// 说明: 此处需要调用云平台认证 API 进行用户登录
// 当前状态: 使用 mock 实现
// 依赖模块: IMP-007
// 补齐优先级: P0
// Mock 文件: src/utils/mock.ts

export const login = async (params: LoginParams) => {
  // #ifdef MOCK
  return mockAuthLogin(params)
  // #endif

  // #ifndef MOCK
  return request.post<LoginResponse>('/api/auth/login', params)
  // #endif
}
```

## 数据模型

### TypeScript 类型定义

#### 通用类型 (`types/common.d.ts`)
```typescript
/** API响应基础结构 */
interface ApiResponse<T = any> {
  code: number
  data: T
  message: string
  timestamp: number
}

/** 分页参数 */
interface PageParams {
  page?: number
  pageSize?: number
}

/** 分页响应 */
interface PageResponse<T> {
  total: number
  list: T[]
}
```

#### 认证相关类型 (`types/auth.d.ts`)
```typescript
/** 登录请求参数 */
interface LoginParams {
  username: string
  password: string
  tenantId?: string
}

/** 登录响应数据 */
interface LoginResponse {
  token: string
  tokenType: string
  expiresIn: number
  refreshToken: string
  userInfo: UserInfo
}

/** 用户信息 */
interface UserInfo {
  id: string
  username: string
  realName: string
  email?: string
  phone?: string
  avatar?: string
  roles: string[]
  permissions?: string[]
  tenant?: TenantInfo
}

/** 租户信息 */
interface TenantInfo {
  id: string
  name: string
}
```

#### 设备相关类型 (`types/device.d.ts`)
```typescript
/** 设备状态枚举 */
enum DeviceStatus {
  Online = 'online',
  Offline = 'offline',
  Error = 'error'
}

/** 设备信息 */
interface Device {
  id: string
  name: string
  type: string
  status: DeviceStatus
  lastSeen: number
  location?: string
  description?: string
  data?: Record<string, any>
}

/** 设备属性 */
interface DeviceProperty {
  name: string
  value: any
  unit?: string
  timestamp: number
}
```

## 实施计划

### 阶段1: 项目初始化与基础配置 (IMP-008 Phase 1)
**目标**: 搭建项目基础架构

- [ ] **任务1.1**: 创建 UniApp 项目
  - 使用 HBuilderX 或 CLI 创建项目
  - 选择 Vue 3 + TypeScript 模板
  - 预估: 0.5小时

- [ ] **任务1.2**: 配置目录结构
  - 创建分层目录 (api/components/pages/stores/...)
  - 设置模块化目录结构
  - 预估: 0.5小时

- [ ] **任务1.3**: 安装和配置依赖
  - 安装 Pinia: `npm install pinia`
  - 安装 UniUI: 配置 easycom
  - 安装 TypeScript 类型声明
  - 预估: 1小时

- [ ] **任务1.4**: 配置工程化工具
  - ESLint 配置
  - Prettier 配置
  - TypeScript 配置 (strict 模式)
  - Vite 配置优化
  - 预估: 1小时

### 阶段2: 基础框架搭建 (IMP-008 Phase 2)
**目标**: 实现基础页面框架和路由配置

- [ ] **任务2.1**: 配置 App.vue
  - 应用生命周期管理
  - 全局样式引入
  - 预估: 0.5小时

- [ ] **任务2.2**: 配置 pages.json
  - 页面路由配置
  - TabBar 配置(5个Tab)
  - 全局样式配置
  - 预估: 1小时

- [ ] **任务2.3**: 配置 manifest.json
  - 应用基本信息
  - 图标和启动图配置
  - 权限配置
  - 预估: 0.5小时

- [ ] **任务2.4**: 创建全局样式
  - variables.scss (主题色、间距、字体)
  - mixins.scss (常用样式混入)
  - reset.scss (样式重置)
  - 预估: 1小时

### 阶段3: 核心模块骨架 (IMP-008 Phase 3)
**目标**: 创建6个核心模块的骨架

- [ ] **任务3.1**: Auth 模块
  - 创建登录页面框架
  - 创建认证 Store (stores/auth.ts)
  - 创建认证 API (api/auth.ts)
  - 预估: 2小时

- [ ] **任务3.2**: Device 模块
  - 创建设备列表页面框架
  - 创建设备 Store (stores/device.ts)
  - 创建设备 API (api/device.ts)
  - 预估: 1.5小时

- [ ] **任务3.3**: Workspace 模块
  - 创建工作台页面框架
  - 创建工作台 Store (stores/workspace.ts)
  - 预估: 1小时

- [ ] **任务3.4**: Dashboard 模块
  - 创建看板页面框架
  - 创建看板 Store (stores/dashboard.ts)
  - 预估: 1小时

- [ ] **任务3.5**: Message 模块
  - 创建消息列表页面框架
  - 创建消息 Store (stores/message.ts)
  - 预估: 1小时

- [ ] **任务3.6**: Profile 模块
  - 创建个人中心页面框架
  - 创建个人中心 Store (stores/profile.ts)
  - 预估: 1小时

### 阶段4: 通用组件库 (IMP-008 Phase 4)
**目标**: 实现7个通用基础组件

- [ ] **任务4.1**: CustomNavBar 组件
  - 自定义导航栏
  - 支持标题、返回、右侧操作
  - 预估: 1小时

- [ ] **任务4.2**: PageContainer 组件
  - 页面容器组件
  - 统一布局和样式
  - 预估: 0.5小时

- [ ] **任务4.3**: Loading 组件
  - 加载指示器
  - 预估: 0.5小时

- [ ] **任务4.4**: EmptyState 组件
  - 空状态提示
  - 预估: 0.5小时

- [ ] **任务4.5**: NetworkError 组件
  - 网络异常提示
  - 支持重试
  - 预估: 0.5小时

- [ ] **任务4.6**: PullRefresh 组件
  - 下拉刷新容器
  - 预估: 0.5小时

- [ ] **任务4.7**: LoadMore 组件
  - 上拉加载更多
  - 预估: 0.5小时

### 阶段5: 工具类和类型定义 (IMP-008 Phase 5)
**目标**: 完善数据层基础设施

- [ ] **任务5.1**: HTTP 请求封装 (utils/request.ts)
  - 基于 uni.request 封装
  - 统一错误处理
  - Token 自动注入
  - 请求/响应拦截器
  - 预估: 2小时

- [ ] **任务5.2**: 本地存储封装 (utils/storage.ts)
  - 封装 uni.storage
  - 类型安全的存储 API
  - 预估: 0.5小时

- [ ] **任务5.3**: 表单验证工具 (utils/validator.ts)
  - 常用验证规则
  - 预估: 0.5小时

- [ ] **任务5.4**: 格式化工具 (utils/format.ts)
  - 日期、数字等格式化
  - 预估: 0.5小时

- [ ] **任务5.5**: TypeScript 类型定义
  - 创建 types/ 目录下所有类型定义文件
  - 预估: 1小时

### 阶段6: 第一个页面实现 (IMP-008 Phase 6)
**目标**: 实现启动页/登录页并验证可运行

- [ ] **任务6.1**: 实现启动页 (pages/index/index.vue)
  - Logo 展示
  - 版本信息显示
  - 自动跳转到登录页
  - 预估: 1小时

- [ ] **任务6.2**: 实现登录页 (pages/auth/login/index.vue)
  - 手机号/邮箱输入
  - 密码输入
  - 登录按钮
  - 基础表单验证
  - API 调用(使用 Mock)
  - 登录成功跳转
  - 预估: 3小时

- [ ] **任务6.3**: 多端运行验证
  - H5 浏览器运行
  - 微信开发者工具运行
  - Android/iOS 模拟器运行(可选)
  - 预估: 2小时

### 阶段7: 开发规范文档 (IMP-008 Phase 7)
**目标**: 编写开发规范文档

- [ ] **任务7.1**: 编写开发规范文档
  - 命名规范
  - 目录结构规范
  - 组件开发规范
  - API 调用规范
  - 状态管理规范
  - 注释和文档规范
  - 预估: 2小时

**总预估**: 约 28 小时

## 风险和挑战

| 风险 | 影响 | 概率 | 缓解措施 | 责任人 |
|------|------|------|---------|--------|
| **UniApp跨平台兼容性问题** | 高 | 中 | 充分测试多端,使用条件编译处理平台差异 | 前端开发 |
| **性能不达标** | 中 | 低 | 使用性能监控工具,优化首屏加载和渲染 | 前端开发 |
| **云平台 API 延迟** | 中 | 中 | 使用依赖忽略机制,Mock 数据先行开发 | 架构师 |
| **第三方插件兼容性** | 中 | 中 | 选择成熟稳定的插件,充分测试 | 前端开发 |
| **TypeScript 学习曲线** | 低 | 低 | 团队培训,参考最佳实践 | 前端开发 |
| **状态管理复杂度** | 中 | 低 | 模块化设计,每个模块独立 Store | 前端开发 |

## 影响分析

### 影响范围
- **模块**:
  - APP 平台 - 新增移动端应用
  - Cloud 平台 - 需提供移动端 API 接口
- **系统**:
  - 新增独立移动端应用
  - 与云平台通过 API 集成
- **功能**: FE-008

### 兼容性
- **向后兼容**: 不影响现有系统
- **版本控制**: 移动端独立版本管理
- **API 兼容性**: 需与云平台 API 保持兼容

### 迁移策略
- 无需迁移,新建项目

## 性能考虑

### 性能指标
- **首屏加载时间**: < 2秒
- **应用启动时间**: < 3秒
- **页面切换响应**: < 300ms
- **API 请求响应**: < 1秒
- **内存占用**: < 150MB

### 优化策略
1. **代码分割**: 使用 Vite 动态导入,按需加载
2. **资源优化**:
   - 图片压缩和懒加载
   - 图标使用 iconfont
   - CDN 加速静态资源
3. **缓存策略**:
   - API 响应缓存
   - 本地存储常用数据
4. **渲染优化**:
   - 虚拟列表处理长列表
   - 防抖/节流处理频繁操作
5. **包体积优化**:
   - Tree-shaking 去除未使用代码
   - 分包配置(主包 + 分包)

## 安全考虑

### 安全威胁
- **中间人攻击**: 使用 HTTPS + 证书固定
- **XSS 攻击**: 输入过滤和转义
- **CSRF 攻击**: Token 认证 + 请求签名
- **敏感数据泄露**: 本地加密存储

### 安全措施
1. **通信安全**:
   - 强制 HTTPS
   - 请求签名验证
   - Token 自动刷新机制

2. **数据安全**:
   - 敏感数据加密存储 (使用 uni.encrypt)
   - Token 安全存储 (使用 uni.storage)
   - 定期清理过期 Token

3. **认证授权**:
   - JWT Token 认证
   - Token 过期自动刷新
   - 登出时清除本地凭证

4. **代码安全**:
   - 生产环境关闭调试
   - 代码混淆和压缩
   - 敏感信息不硬编码

## 测试策略

### 单元测试
- **测试框架**: Vitest
- **覆盖范围**:
  - Utils 工具函数 (100%)
  - Composables 业务逻辑 (80%)
  - API 接口封装 (70%)
- **工具**: Vitest + Vue Test Utils

### 集成测试
- **测试场景**:
  - 登录流程测试
  - 设备列表加载测试
  - 页面导航测试
  - 状态管理测试
- **工具**: Playwright (多端测试)

### 性能测试
- **测试工具**:
  - Lighthouse (性能评分)
  - Chrome DevTools (性能分析)
- **测试指标**:
  - 首屏加载时间
  - 内存占用
  - CPU 使用率
  - 网络请求数

### 多端兼容性测试
- **测试环境**:
  - H5 (Chrome, Safari, 微信内置浏览器)
  - 微信小程序
  - Android (7.0+)
  - iOS (12.0+)

## 变更历史
| 日期 | 版本 | 变更内容 | 变更人 | 评审状态 |
|------|------|---------|--------|---------|
| 2026-01-28 | 1.0 | 初始创建 | Claude Code | 待评审 |

## 附录

### 相关文档
- FE-008: 移动端项目初始化功能需求
- REQ-008: 移动端项目初始化需求
- UniApp 官方文档: https://uniapp.dcloud.net.cn/
- Vue 3 官方文档: https://cn.vuejs.org/
- Pinia 官方文档: https://pinia.vuejs.org/zh/

### 架构决策记录 (ADR)
详见独立文档:
- `.claude-workflow/03-design/architecture/adr/adr-001-uniaap-framework.md`
- `.claude-workflow/03-design/architecture/adr/adr-002-pinia-state-management.md`
- `.claude-workflow/03-design/architecture/adr/adr-003-modular-architecture.md`
