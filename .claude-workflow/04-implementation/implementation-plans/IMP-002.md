# IMP-002: Scada工程管理功能实施计划

## 实施计划信息

**计划ID**: IMP-002
**计划标题**: Scada工程管理功能实施计划
**关联需求**: REQ-002, FE-002, US-002
**技术方案**: SOL-002
**架构决策**: ADR-002
**创建日期**: 2026-01-21
**目标平台**: Scada (前端 + 后端)
**状态**: ⏳ 待实施

---

## 实施概述

本实施计划将Scada工程管理功能分解为可执行的任务，按照依赖关系和优先级组织实施顺序。

### 实施原则

1. **前端优先**: 先实现UI和交互，后端API使用Mock数据
2. **渐进式**: 先基础功能，后高级功能
3. **并行开发**: 前后端可并行开发
4. **测试驱动**: 每个功能完成后立即测试

### 总体进度

- **预计总工作量**: 16人日
- **前端**: 8人日
- **后端**: 6人日
- **联调测试**: 2人日

---

## 阶段1: 基础设施搭建 (2人日)

### 1.1 前端基础配置 (0.5人日)

**任务**: 配置前端开发环境和依赖

**文件**:
- `src/types/project.ts` - 工程类型定义
- `src/api/projectApi.ts` - API客户端骨架
- `src/utils/dateFormat.ts` - 日期格式化工具

**步骤**:
1. 安装依赖：`bcryptjs`, `react-window`
2. 创建工程类型定义
3. 创建API客户端基础结构
4. 创建日期格式化工具函数

**验收**:
- [ ] TypeScript编译通过
- [ ] 类型定义完整
- [ ] API客户端结构清晰

---

### 1.2 后端基础配置 (0.5人日)

**任务**: 配置后端开发环境和依赖

**文件**:
- `platforms/scada/backend/go.mod` - 添加依赖
- `platforms/scada/backend/internal/model/project.go` - 工程数据模型
- `platforms/scada/backend/internal/api/project_api.go` - API骨架

**步骤**:
1. 添加Go依赖：
   - `github.com/gofiber/fiber/v2`
   - `gorm.io/gorm`
   - `gorm.io/driver/sqlite`
   - `golang.org/x/crypto/bcrypt`
2. 创建工程数据模型
3. 创建API路由骨架
4. 配置CORS和中间件

**验收**:
- [ ] Go编译通过
- [ ] 数据模型定义正确
- [ ] API路由注册成功

---

### 1.3 数据库初始化 (1人日)

**任务**: 创建SQLite数据库和表结构

**文件**:
- `platforms/scada/backend/internal/database/db.go` - 数据库连接
- `platforms/scada/backend/internal/database/migrations/001_init.sql` - 初始化SQL

**步骤**:
1. 创建数据库连接逻辑
2. 设计表结构：
   - `recent_projects`表
   - `categories`表（可选）
3. 实现数据库迁移
4. 实现CRUD基础函数

**表结构**:
```sql
CREATE TABLE recent_projects (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    project_id TEXT NOT NULL UNIQUE,
    name TEXT NOT NULL,
    category TEXT,
    file_path TEXT NOT NULL,
    last_opened DATETIME NOT NULL,
    is_encrypted BOOLEAN DEFAULT 0,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_last_opened ON recent_projects(last_opened DESC);
CREATE INDEX idx_category ON recent_projects(category);
```

**验收**:
- [ ] 数据库文件创建成功
- [ ] 表结构创建成功
- [ ] 索引创建成功
- [ ] 可以执行CRUD操作

---

## 阶段2: 前端UI实现 (5人日)

### 2.1 NewProjectDialog组件 (2人日)

**任务**: 实现新建工程对话框

**文件**:
- `src/components/project/NewProjectDialog.tsx`
- `src/components/project/NewProjectDialog.css`
- `src/components/project/PasswordStrengthIndicator.tsx`

**功能点**:
1. 对话框布局
2. 表单字段渲染
3. 表单验证
4. 密码强度指示
5. 文件夹选择器集成
6. 自定义分类输入
7. 提交处理

**详细步骤**:

**步骤1**: 对话框布局 (0.5人日)
- 实现模态遮罩
- 对话框容器
- 头部（标题 + 关闭按钮）
- 底部（取消 + 确定按钮）

**步骤2**: 表单字段 (0.5人日)
- 工程名称输入
- 工程作者输入
- 工程描述多行输入
- 工程分类下拉选择
- 硬件平台下拉选择
- 保存位置输入 + 浏览按钮

**步骤3**: 表单验证 (0.3人日)
- 必填字段验证
- 字符长度限制
- 实时验证反馈
- 提交前总体验证

**步骤4**: 密码相关 (0.4人日)
- 加密复选框
- 密码输入框（条件显示）
- 确认密码输入框
- 密码强度指示器
- 密码可见性切换

**步骤5**: 文件夹选择 (0.3人日)
- 集成Electron dialog API
- 显示选择路径
- 路径有效性验证

**验收**:
- [ ] 对话框正确显示
- [ ] 所有表单字段正确渲染
- [ ] 表单验证规则生效
- [ ] 文件夹选择功能正常
- [ ] 密码强度指示准确
- [ ] 提交后调用API

---

### 2.2 RecentProjectsList组件 (2人日)

**任务**: 实现最近工程列表视图

**文件**:
- `src/components/workspace/RecentProjectsList.tsx`
- `src/components/workspace/RecentProjectsList.css`
- `src/components/workspace/ProjectListItem.tsx`
- `src/components/workspace/ProjectListItem.css`

**功能点**:
1. 虚拟滚动列表
2. 列表项渲染
3. 悬停效果
4. 键盘导航
5. 右键菜单

**详细步骤**:

**步骤1**: 列表容器 (0.5人日)
- 集成react-window
- 配置列表参数
- 实现空状态提示

**步骤2**: ProjectListItem组件 (0.8人日)
- 工程信息展示
- 分类标签
- 加密图标
- 时间格式化
- 路径显示
- 悬停高亮

**步骤3**: 交互功能 (0.7人日)
- 点击打开工程
- 右键菜单
- 键盘导航
- 焦点管理

**验收**:
- [ ] 列表流畅滚动（50个工程）
- [ ] 列表项信息完整
- [ ] 点击打开工程
- [ ] 右键菜单功能正常
- [ ] 键盘导航流畅

---

### 2.3 CategoryFilter组件 (0.5人日)

**任务**: 实现分类筛选器

**文件**:
- `src/components/workspace/CategoryFilter.tsx`
- `src/components/workspace/CategoryFilter.css`

**功能点**:
1. 分类标签横向滚动
2. 数量徽章
3. 选中状态高亮
4. 点击筛选

**验收**:
- [ ] 标签横向滚动
- [ ] 显示工程数量
- [ ] 点击筛选生效
- [ ] 样式符合设计规范

---

### 2.4 SearchBox组件 (0.5人日)

**任务**: 实现搜索框

**文件**:
- `src/components/workspace/SearchBox.tsx`
- `src/components/workspace/SearchBox.css`

**功能点**:
1. 搜索输入框
2. 搜索图标
3. 清除按钮
4. 防抖处理

**验收**:
- [ ] 输入框响应输入
- [ ] 100ms防抖
- [ ] 清除按钮功能正常
- [ ] 样式符合设计规范

---

## 阶段3: 后端API实现 (4人日)

### 3.1 加密服务 (1.5人日)

**任务**: 实现加密/解密/签名功能

**文件**:
- `platforms/scada/backend/internal/security/encryption.go`
- `platforms/scada/backend/internal/security/encryption_test.go`

**功能点**:
1. AES-256-GCM加密/解密
2. PBKDF2密钥派生
3. HMAC-SHA256签名
4. bcrypt密码哈希

**详细步骤**:

**步骤1**: AES-256-GCM实现 (0.5人日)
- Encrypt函数
- Decrypt函数
- IsEncrypted判断

**步骤2**: 签名功能 (0.5人日)
- GenerateSignature
- VerifySignature

**步骤3**: 测试 (0.5人日)
- 单元测试
- 性能测试
- 边界条件测试

**验收**:
- [ ] 加密/解密功能正常
- [ ] 签名验证有效
- [ ] 单元测试通过
- [ ] 性能满足要求（< 100ms）

---

### 3.2 ProjectService服务 (1.5人日)

**任务**: 实现工程业务逻辑

**文件**:
- `platforms/scada/backend/internal/service/project_service.go`
- `platforms/scada/backend/internal/service/file_service.go`

**功能点**:
1. CreateProject
2. OpenProject
3. SaveProject
4. 文件读写
5. UUID生成

**详细步骤**:

**步骤1**: 创建工程 (0.5人日)
- 生成UUID
- 创建工程对象
- 生成签名
- 序列化JSON
- 加密（可选）
- 写入文件

**步骤2**: 打开工程 (0.5人日)
- 读取文件
- 解密（如果加密）
- 反序列化JSON
- 验证签名
- 验证密码

**步骤3**: 保存工程 (0.5人日)
- 更新时间戳
- 重新生成签名
- 序列化
- 加密（可选）
- 写入文件

**验收**:
- [ ] 创建工程功能正常
- [ ] 打开工程功能正常
- [ ] 保存工程功能正常
- [ ] 加密工程正确处理
- [ ] 签名验证有效

---

### 3.3 API端点实现 (1人日)

**任务**: 实现HTTP API

**文件**:
- `platforms/scada/backend/internal/api/project_api.go`

**功能点**:
1. POST /api/projects/create
2. POST /api/projects/open
3. POST /api/projects/save
4. POST /api/projects/validate-password

**详细步骤**:

**步骤1**: 创建工程API (0.3人日)
- 请求解析
- 参数验证
- 调用Service
- 返回响应

**步骤2**: 打开工程API (0.3人日)
- 请求解析
- 调用Service
- 错误处理（密码错误、文件损坏）

**步骤3**: 其他API (0.4人日)
- 保存工程
- 密码验证
- 错误码统一

**验收**:
- [ ] 所有API端点正常工作
- [ ] 错误处理完善
- [ ] 响应格式统一
- [ ] 可以用Postman测试

---

## 阶段4: 状态管理实现 (2人日)

### 4.1 ProjectStore (1人日)

**任务**: 实现工程状态管理

**文件**:
- `src/store/projectStore.ts`
- `src/store/projectStore.test.ts`

**功能点**:
1. currentProject状态
2. createProject方法
3. openProject方法
4. saveProject方法
5. 错误处理

**详细步骤**:

**步骤1**: 状态定义 (0.2人日)
- observable属性
- computed属性

**步骤2**: 创建工程 (0.3人日)
- API调用
- 状态更新
- 错误处理

**步骤3**: 打开工程 (0.3人日)
- API调用
- 密码处理
- 状态更新

**验收**:
- [ ] MobX状态正常工作
- [ ] API调用正确
- [ ] 错误处理完善
- [ ] 响应式更新生效

---

### 4.2 RecentProjectsStore (1人日)

**任务**: 实现最近工程状态管理

**文件**:
- `src/store/recentProjectsStore.ts`

**功能点**:
1. recentProjects列表
2. 分类筛选
3. 搜索
4. 排序
5. 持久化

**详细步骤**:

**步骤1**: 基础状态 (0.2人日)
- observable属性
- 数据加载

**步骤2**: 过滤和排序 (0.4人日)
- computed: filteredProjects
- computed: categoryStats
- 实现排序逻辑

**步骤3**: 操作方法 (0.4人日)
- addOrUpdateRecentProject
- removeRecentProject
- 同步到后端

**验收**:
- [ ] 状态管理正常
- [ ] 过滤功能正确
- [ ] 搜索功能正确
- [ ] 排序功能正确
- [ ] 数据持久化正常

---

## 阶段5: 集成与测试 (2人日)

### 5.1 API集成 (0.5人日)

**任务**: 前后端API联调

**步骤**:
1. 配置CORS
2. 前端调用真实API
3. 处理跨域错误
4. 处理网络错误
5. 实现重试逻辑

**验收**:
- [ ] 前端可以调用后端API
- [ ] 数据传输正确
- [ ] 错误处理完善

---

### 5.2 Electron集成 (0.5人日)

**任务**: 集成Electron功能

**步骤**:
1. 实现Electron preload脚本
2. 暴露dialog API
3. 暴露文件系统API
4. 前端调用Electron API
5. 测试文件选择功能

**文件**:
- `platforms/scada/packages/desktop/preload.ts`
- `platforms/scada/packages/desktop/electron-main.ts`

**验收**:
- [ ] 文件选择对话框正常
- [ ] 文件读写正常
- [ ] 窗口控制正常

---

### 5.3 端到端测试 (1人日)

**任务**: 完整流程测试

**测试用例**:

**用例1**: 创建工程流程
1. 点击"新建工程"
2. 填写所有信息
3. 启用加密
4. 提交创建
5. 验证工程文件创建
6. 验证文件加密

**用例2**: 打开工程流程
1. 点击"从文件打开"
2. 选择工程文件
3. 输入密码（如果加密）
4. 验证工程加载
5. 验证编辑器打开

**用例3**: 最近工程流程
1. 打开3个不同工程
2. 查看最近工程列表
3. 按分类筛选
4. 搜索工程名称
5. 点击打开工程

**用例4**: 错误处理
1. 尝试打开损坏的文件
2. 输入错误密码
3. 验证错误提示

**验收**:
- [ ] 所有测试用例通过
- [ ] 用户体验流畅
- [ ] 错误提示友好

---

## 阶段6: 优化与文档 (1人日)

### 6.1 性能优化 (0.5人日)

**任务**: 优化性能

**步骤**:
1. 前端性能分析
2. 虚拟滚动性能调优
3. 搜索防抖优化
4. MobX computed优化
5. 减少不必要的重渲染

**验收**:
- [ ] 列表滚动流畅（60fps）
- [ ] 搜索响应迅速（< 100ms）
- [ ] 无明显性能问题

---

### 6.2 文档完善 (0.5人日)

**任务**: 完善技术文档

**步骤**:
1. API文档
2. 组件使用说明
3. 数据格式说明
4. 部署指南
5. 故障排查指南

**验收**:
- [ ] API文档完整
- [ ] 代码注释充分
- [ ] 使用说明清晰

---

## 阶段7: 密码解锁工具实现 (3人日)

**说明**: 本阶段实现独立的官方密码解锁工具，用于帮助用户找回忘记密码的工程。此工具不集成在PanTool中，仅官方客服使用。

### 7.1 双重加密机制改造 (1人日)

**任务**: 改造工程加密机制，支持DEK + KEK双重加密

**文件**:
- `platforms/scada/backend/internal/security/key_encryption.go`
- `platforms/scada/backend/internal/model/project.go` - 更新数据模型
- `platforms/scada/backend/internal/service/project_service.go` - 更新加密逻辑

**功能点**:
1. 生成数据加密密钥(DEK)
2. 使用用户密码加密DEK
3. 使用官方KEK加密DEK
4. 工程内容使用DEK加密
5. 更新工程文件结构

**详细步骤**:

**步骤1**: DEK生成和管理 (0.3人日)
- 实现GenerateDEK函数（生成256位随机密钥）
- 实现EncryptDEKWithUserPassword（使用用户密码加密DEK）
- 实现EncryptDEKWithKEK（使用KEK加密DEK）
- 实现DecryptDEKWithUserPassword（用户解密DEK）
- 实现DecryptDEKWithKEK（官方解密DEK）

**步骤2**: 工程加密流程改造 (0.4人日)
- 创建工程时生成DEK
- 使用DEK加密工程内容
- 生成两份DEK加密副本
- 更新工程文件结构
- 保持向后兼容（未使用KEK的旧版本）

**步骤3**: 工程解密流程改造 (0.3人日)
- 优先使用用户密码解密DEK
- 如果失败，回退到直接加密（旧版本兼容）
- 验证解密后的内容完整性

**验收**:
- [ ] 新创建的工程支持双重加密
- [ ] 可以使用用户密码解密
- [ ] 可以使用KEK解密
- [ ] 旧版本工程文件仍可打开

---

### 7.2 KEK管理系统 (0.5人日)

**任务**: 实现官方主密钥(KEK)管理

**文件**:
- `platforms/scada/backend/internal/security/kek_manager.go`
- `platforms/scada/backend/internal/security/kek_manager_test.go`
- `platforms/scada/backend/internal/config/kek_config.go`

**功能点**:
1. KEK生成和存储
2. KEK版本管理
3. KEK访问控制
4. KEK轮换机制
5. KEK加密导出（用于HSM）

**详细步骤**:

**步骤1**: KEK基础管理 (0.2人日)
- 实现GenerateKEK（生成256位主密钥）
- 实现StoreKEK（安全存储到文件/HSM）
- 实现LoadKEK（从文件/HSM加载）
- 实现KEK版本管理

**步骤2**: KEK安全措施 (0.3人日)
- KEK加密存储（使用系统级密钥）
- KEK访问日志记录
- KEK访问权限控制
- KEK备份和恢复

**验收**:
- [ ] KEK生成安全随机
- [ ] KEK存储加密保护
- [ ] KEK访问有日志
- [ ] 支持KEK版本管理

---

### 7.3 官方解锁工具实现 (1.5人日)

**任务**: 实现独立的密码解锁CLI工具

**文件**:
- `tools/password-recovery-tool/main.go`
- `tools/password-recovery-tool/commands/remove_password.go`
- `tools/password-recovery-tool/commands/reset_password.go`
- `tools/password-recovery-tool/commands/batch.go`
- `tools/password-recovery-tool/verification/proof_validator.go`
- `tools/password-recovery-tool/audit/logger.go`

**功能点**:
1. 移除密码命令
2. 重置密码命令
3. 批量处理命令
4. 所有权验证
5. 审计日志

**详细步骤**:

**步骤1**: CLI框架搭建 (0.3人日)
- 使用cobra库实现CLI框架
- 实现子命令结构
- 实现参数解析
- 实现帮助文档

**步骤2**: 移除密码功能 (0.4人日)
- 读取工程文件
- 验证所有权证明
- 使用KEK解密DEK
- 使用DEK解密工程内容
- 移除密码保护
- 更新工程元数据
- 保存新工程文件
- 记录审计日志

**步骤3**: 重置密码功能 (0.4人日)
- 读取工程文件
- 验证所有权证明
- 使用KEK解密DEK
- 使用DEK解密工程内容
- 设置新用户密码
- 重新加密DEK
- 保存新工程文件
- 记录审计日志

**步骤4**: 所有权验证 (0.2人日)
- 实现ProofValidator
- 支持多种证明类型：
  * 购买凭证验证
  * 邮箱验证
  * Machine ID验证
  * 工程元数据验证
- 至少需要2项证明通过

**步骤5**: 批量处理 (0.2人日)
- 支持CSV输入文件
- 批量验证所有权
- 批量处理解锁请求
- 生成处理报告

**验收**:
- [ ] CLI工具功能正常
- [ ] 移除密码功能正确
- [ ] 重置密码功能正确
- [ ] 批量处理功能正常
- [ ] 所有权验证有效
- [ ] 审计日志完整
- [ ] 工具有使用文档

---

## 阶段8: 前端密码找回指南 (0.5人日)

**任务**: 在前端添加密码找回引导界面

**文件**:
- `src/components/help/PasswordRecoveryGuide.tsx`
- `src/components/help/PasswordRecoveryGuide.css`
- `src/components/project/PasswordDialog.tsx` - 添加"忘记密码？"链接

**功能点**:
1. "忘记密码？"链接
2. 密码找回指南页面
3. 所需材料清单
4. 官方联系方式
5. 常见问题解答

**详细步骤**:

**步骤1**: 添加"忘记密码"链接 (0.1人日)
- 在PasswordDialog中添加链接
- 链接样式符合设计规范
- 点击打开指南页面

**步骤2**: 实现指南页面 (0.4人日)
- 显示找回步骤
- 列出所需材料
- 显示官方联系方式
- 添加FAQ部分

**验收**:
- [ ] "忘记密码？"链接显示正确
- [ ] 指南页面内容完整
- [ ] 联系方式准确
- [ ] 样式符合设计规范

---

## 阶段9: 代码映射表更新

### 前端文件映射

| 功能需求 | 代码文件 | 行数估算 |
|---------|---------|---------|
| FE-002-1 | NewProjectDialog.tsx | 350行 |
| FE-002-1 | NewProjectDialog.css | 150行 |
| FE-002-2 | PasswordDialog.tsx | 80行 |
| FE-002-2 | projectApi.ts | 200行 |
| FE-002-3 | RecentProjectsList.tsx | 250行 |
| FE-002-3 | ProjectListItem.tsx | 120行 |
| FE-002-3 | CategoryFilter.tsx | 100行 |
| FE-002-3 | SearchBox.tsx | 80行 |
| FE-002-3 | RecentProjectsList.css | 200行 |
| FE-002-3 | recentProjectsManager.ts | 150行 |
| FE-002-4 | project.ts (types) | 100行 |
| FE-002-4 | projectStore.ts | 250行 |
| FE-002-4 | recentProjectsStore.ts | 200行 |
| FE-002-5 | projectApi.ts | 200行 |
| FE-002-8 | PasswordRecoveryGuide.tsx | 180行 |
| FE-002-8 | PasswordRecoveryGuide.css | 120行 |
| **总计** | **16个文件** | **~2830行** |

### 后端文件映射

| 功能需求 | 代码文件 | 行数估算 |
|---------|---------|---------|
| FE-002-6 | project_api.go | 300行 |
| FE-002-6 | project_service.go | 400行 |
| FE-002-6 | file_service.go | 150行 |
| FE-002-7 | encryption.go | 350行 |
| FE-002-7 | encryption_test.go | 200行 |
| FE-002-6 | project.go (model) | 100行 |
| FE-002-6 | db.go | 100行 |
| FE-002-6 | 001_init.sql | 30行 |
| FE-002-8 | key_encryption.go | 400行 |
| FE-002-8 | kek_manager.go | 250行 |
| FE-002-8 | kek_manager_test.go | 150行 |
| FE-002-8 | audit_log.go (model) | 100行 |
| **总计** | **12个文件** | **~2530行** |

### 官方工具文件映射

| 功能需求 | 代码文件 | 行数估算 |
|---------|---------|---------|
| FE-002-8 | main.go (CLI) | 150行 |
| FE-002-8 | remove_password.go | 300行 |
| FE-002-8 | reset_password.go | 320行 |
| FE-002-8 | batch.go | 250行 |
| FE-002-8 | proof_validator.go | 400行 |
| FE-002-8 | logger.go (audit) | 200行 |
| FE-002-8 | README.md | 150行 |
| **总计** | **7个文件** | **~1770行** |

**全部统计**:
- 前端：16个文件，~2830行
- 后端：12个文件，~2530行
- 官方工具：7个文件，~1770行
- **合计：35个文件，~7130行代码**

---

## 依赖关系图

```
阶段1: 基础设施
  ├─ 1.1 前端基础配置
  ├─ 1.2 后端基础配置
  └─ 1.3 数据库初始化
      ↓
阶段2: 前端UI (可并行)
  ├─ 2.1 NewProjectDialog ──→ 依赖 1.1
  ├─ 2.2 RecentProjectsList ──→ 依赖 1.1
  ├─ 2.3 CategoryFilter ──→ 依赖 1.1
  └─ 2.4 SearchBox ──→ 依赖 1.1
      ↓
阶段3: 后端API (可并行)
  ├─ 3.1 加密服务 ──→ 依赖 1.2
  ├─ 3.2 ProjectService ──→ 依赖 1.3, 3.1
  └─ 3.3 API端点 ──→ 依赖 3.2
      ↓
阶段4: 状态管理 ──→ 依赖 1.1, 1.3
  ├─ 4.1 ProjectStore
  └─ 4.2 RecentProjectsStore
      ↓
阶段5: 集成测试 ──→ 依赖 2, 3, 4
  ├─ 5.1 API集成
  ├─ 5.2 Electron集成
  └─ 5.3 端到端测试
      ↓
阶段6: 优化文档 ──→ 依赖 5
  ├─ 6.1 性能优化
  └─ 6.2 文档完善
      ↓
阶段7: 密码解锁工具 ──→ 依赖 3.1, 可独立开发
  ├─ 7.1 双重加密机制 ──→ 改造加密服务
  ├─ 7.2 KEK管理系统 ──→ 独立模块
  └─ 7.3 官方解锁工具 ──→ 独立CLI工具
      ↓
阶段8: 前端密码找回指南 ──→ 依赖 7
  └─ 8.1 添加"忘记密码？"链接和指南页面
```

---

## 实施顺序建议

### 顺序1: 基础功能优先（推荐）
1. 先实现阶段1-6：基础工程管理功能
2. 再实现阶段7-8：密码解锁工具
3. 适合快速MVP发布

### 顺序2: 一次性完成
适合有充足时间的开发，一次性实现所有功能。

### 顺序3: 并行开发
- 团队A：阶段1-6（基础功能）
- 团队B：阶段7（密码解锁工具，独立开发）
- 最后集成

---

## 里程碑

| 里程碑 | 完成标准 | 预计时间 |
|-------|---------|---------|
| M1: 基础设施完成 | 数据库、API骨架、类型定义 | 第1天 |
| M2: 前端UI完成 | 所有UI组件实现 | 第3天 |
| M3: 后端API完成 | 所有API实现并测试通过 | 第5天 |
| M4: 功能集成完成 | 前后端联调通过 | 第6天 |
| M5: 测试完成 | 所有测试用例通过 | 第7天 |
| M6: 基础功能发布 | 性能优化、文档完善 | 第8天 |
| M7: 密码解锁工具完成 | 双重加密、解锁工具 | 第11天 |
| M8: 密码找回指南完成 | 前端指南页面 | 第11.5天 |

---

## 风险与缓解

### 风险1: Electron集成复杂
**影响**: 中等
**概率**: 高
**缓解措施**:
- 参考Electron官方示例
- 早期验证关键技术
- 准备降级方案

### 风险2: 加密性能问题
**影响**: 低
**概率**: 中
**缓解措施**:
- 性能测试
- 优化算法
- 异步处理

### 风险3: 虚拟滚动兼容性
**影响**: 低
**概率**: 低
**缓解措施**:
- 选择成熟库（react-window）
- 充分测试
- 准备降级方案（分页）

### 风险4: KEK泄露
**影响**: 极高
**概率**: 低
**缓解措施**:
- KEK存储在HSM中
- 多重授权访问
- 定期安全审计
- 应急响应预案

### 风险5: 密码找回被滥用
**影响**: 高
**概率**: 中
**缓解措施**:
- 严格的所有权验证
- 人工审核机制
- 完整的审计日志
- 定期审查解锁记录

---

## 验收清单

### 功能验收
- [ ] 可以创建新工程
- [ ] 可以打开工程
- [ ] 可以保存工程
- [ ] 加密工程功能正常
- [ ] 最近工程列表正常
- [ ] 分类筛选正常
- [ ] 搜索功能正常
- [ ] 右键菜单功能正常
- [ ] 键盘导航流畅
- [ ] 工程支持双重加密
- [ ] 官方可以解锁工程
- [ ] 密码找回指南可用

### 性能验收
- [ ] 创建工程 < 1秒
- [ ] 打开工程 < 2秒
- [ ] 保存工程 < 1秒
- [ ] 列表滚动 60fps
- [ ] 搜索响应 < 100ms

### 安全验收
- [ ] 加密工程无法被其他工具打开
- [ ] 密码验证正确
- [ ] 文件签名验证有效
- [ ] 篡改文件被检测
- [ ] KEK安全管理到位
- [ ] 解锁操作有审计日志

### 用户体验验收
- [ ] 界面简洁直观
- [ ] 表单验证提示清晰
- [ ] 错误信息友好
- [ ] 交互流畅
- [ ] 密码找回流程清晰

---

## 相关文档

- 原始需求: REQ-002
- 功能需求: FE-002
- 用户故事: US-002
- 技术方案: SOL-002
- 架构决策: ADR-002

---

**文档版本**: 1.1
**最后更新**: 2026-01-21
**审批人**: 待审批
