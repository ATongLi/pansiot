# 需求映射表 (Requirement Mapping Table)

更新时间: 2026-01-28

## 映射关系

| REQ-{N} | FE-{N} | 平台 | 功能描述 | 状态 |
|---------|--------|------|----------|------|
| REQ-001 | FE-001 | Scada | Scada主页面布局功能 | ✅ 已完成 |
| REQ-001 | FE-002 | Scada | 自定义标题栏实现 | ✅ 已完成 |
| REQ-001 | FE-003 | Scada | 侧边栏导航优化 | ✅ 已完成 |
| REQ-001 | FE-004 | Scada | 主内容区工作区优化 | ✅ 已完成 |
| REQ-001 | FE-005 | Scada | 移除页面内旧顶部导航栏 | ✅ 已完成 |
| REQ-006 | FE-006 | Scada | 工程编辑器整体布局与组件架构 | 🎨 设计中 |
| REQ-007 | FE-007-01 | Cloud | 多租户组织管理 | 📋 待设计 |
| REQ-007 | FE-007-02 | Cloud | 用户注册与登录 | 📋 待设计 |
| REQ-007 | FE-007-03 | Cloud | RBAC权限模型 | 📋 待设计 |
| REQ-007 | FE-007-04 | Cloud | 租户数据隔离 | 📋 待设计 |
| REQ-007 | FE-007-05 | Cloud | 租户角色切换 | 📋 待设计 |
| REQ-007 | FE-007-06 | Cloud | 前端动态界面 | 📋 待设计 |
| REQ-007 | FE-007-07 | Cloud | 后端API服务 | 📋 待设计 |
| REQ-007 | FE-007-08 | Cloud | 功能模块与配额管理 | 📋 待设计 |
| REQ-007 | FE-007-09 | Cloud | 系统审计日志 | 📋 待设计 |
| REQ-008 | FE-008 | APP | 移动端项目初始化 | 📋 待设计 |
| REQ-009 | FE-009 | Scada | 界面和组件结构优化 | 📋 待设计 |

## 功能需求统计

### 按平台分类
- **Scada**: 7个功能需求 (FE-001, FE-002, FE-003, FE-004, FE-005, FE-006, FE-009)
  - 已完成: 5个
  - 设计中: 1个 (FE-006)
  - 待设计: 1个 (FE-009)

- **Cloud**: 9个功能需求 (FE-007-01 ~ FE-007-09)
  - 待设计: 9个

- **APP**: 1个功能需求 (FE-008)
  - 待设计: 1个

### 按状态分类
- **✅ 已完成**: 5个
- **📋 待设计**: 11个
- **🎨 设计中**: 1个
- **💻 实施中**: 0个
- **🧪 测试中**: 0个

## REQ-006 详细分解

### 功能需求: FE-006
**标题**: 工程编辑器整体布局与组件架构
**来源**: REQ-006
**平台**: Scada
**状态**: 📋 待设计

#### 子功能列表 (15个)
1. **FE-006-01**: 工程标签页管理功能 (P0)
2. **FE-006-02**: 工程编辑器主布局 (P0)
3. **FE-006-03**: 顶部工具导航栏 (P0)
4. **FE-006-04**: 子工具栏 (P1)
5. **FE-006-05**: 左侧导航栏容器与Tab切换 (P0)
6. **FE-006-06**: 项目面板 (P1)
7. **FE-006-07**: 组件面板 (P1)
8. **FE-006-08**: 属性面板 (P1)
9. **FE-006-09**: 图层面板 (P1)
10. **FE-006-10**: 数据面板 (P2)
11. **FE-006-11**: 子页面标签栏 (P0)
12. **FE-006-12**: 画布区域 (P0)
13. **FE-006-13**: 底部状态栏 (P0)
14. **FE-006-14**: MobX状态管理架构 (P0)
15. **FE-006-15**: 样式系统与设计规范 (P0)

#### 优先级统计
- **P0 (必须实现)**: 9个子功能
- **P1 (重要)**: 5个子功能
- **P2 (可选)**: 1个子功能

## 依赖关系

### FE-006 依赖
- **前置依赖**:
  - FE-001: Scada主页面布局功能 ✅ 已完成
  - FE-005: 自定义TitleBar实现 ✅ 已完成

- **后置依赖**:
  - 画布交互功能 (后续需求)
  - 组件拖拽功能 (后续需求)
  - 属性编辑功能 (后续需求)
  - 数据绑定功能 (后续需求)
  - 工程保存加载功能 (后续需求)

## 平台分配

### Scada平台
**已分配功能需求**:
- FE-001: Scada主页面布局功能 ✅
- FE-002: 自定义标题栏实现 ✅
- FE-003: 侧边栏导航优化 ✅
- FE-004: 主内容区工作区优化 ✅
- FE-005: 移除页面内旧顶部导航栏 ✅
- FE-006: 工程编辑器整体布局与组件架构 📋
- FE-009: 界面和组件结构优化 📋

**平台进度**: 5个已完成 / 1个设计中 / 1个待设计

## 追溯矩阵

### 正向追溯 (REQ → FE → Code)
- **REQ-001** → FE-001 → `platforms/scada/packages/renderer/src/`
- **REQ-001** → FE-002 → `platforms/scada/packages/renderer/src/components/layout/TitleBar.tsx`
- **REQ-001** → FE-003 → `platforms/scada/packages/renderer/src/components/layout/Sidebar.tsx`
- **REQ-001** → FE-004 → `platforms/scada/packages/renderer/src/components/layout/MainContent.tsx`
- **REQ-001** → FE-005 → `platforms/scada/packages/renderer/src/components/layout/TitleBar.tsx`
- **REQ-006** → FE-006 → (待实施)

### 反向追溯 (Code → FE → REQ)
- `TitleBar.tsx` → FE-002, FE-005 → REQ-001
- `Sidebar.tsx` → FE-003 → REQ-001
- `MainContent.tsx` → FE-004 → REQ-001
- (FE-006代码位置待确定)

## 完成度统计

### 整体进度
- **原始需求数**: 5个 (REQ-001, REQ-006, REQ-007, REQ-008, REQ-009)
- **功能需求数**: 17个 (FE-001 ~ FE-009, FE-007-01 ~ FE-007-09)
  - Scada: 7个 (FE-001 ~ FE-006, FE-009)
  - Cloud: 9个 (FE-007-01 ~ FE-007-09)
  - APP: 1个 (FE-008)
- **已完成功能**: 5个 (29.4%)
- **待设计功能**: 11个 (64.7%)
- **设计中功能**: 1个 (5.9%)

### REQ-007 进度
- **需求阶段**: ✅ 完成
- **分解阶段**: ✅ 完成
- **设计阶段**: 📋 待启动
- **实施阶段**: ⏳ 待启动
- **测试阶段**: ⏳ 待启动

### REQ-006 进度
- **需求阶段**: ✅ 完成
- **分解阶段**: ✅ 完成
- **设计阶段**: 📋 待启动
- **实施阶段**: ⏳ 待启动
- **测试阶段**: ⏳ 待启动

## REQ-007 详细分解

### 功能需求系列: FE-007-01 ~ FE-007-09
**标题**: 云平台账号系统 - 多租户组织管理与RBAC权限控制
**来源**: REQ-007
**平台**: Cloud (云平台端)
**状态**: 📋 待设计

#### 子功能列表 (9个)
1. **FE-007-01**: 多租户组织管理 (P0)
   - 组织实体设计（managed_by, parent_id字段）
   - 组织类型（平台超管、集成商、下游客户、子组织）
   - 企业序列号生成
   - 组织CRUD功能
   - 组织树形结构展示

2. **FE-007-02**: 用户注册与登录 (P0)
   - 新企业注册（自动创建组织+系统管理员角色）
   - 加入已有企业（通过企业序列号）
   - 手机号/邮箱注册（支持国际区号）
   - 验证码验证（可mock）
   - 登录功能（JWT Token）
   - 密码强度验证

3. **FE-007-03**: RBAC权限模型 (P0)
   - 三级权限架构（系统角色→功能权限→操作权限）
   - 预定义角色（系统管理员、组织管理员、普通用户）
   - 自定义角色创建
   - 权限配置界面
   - 权限验证中间件

4. **FE-007-04**: 租户数据隔离 (P0)
   - 双字段设计（tenant_id, managed_by_id）
   - 数据隔离中间件
   - 集成商查看所有下游数据
   - 下游客户仅查看自己的数据
   - 跨主体严格隔离

5. **FE-007-05**: 租户角色切换 (P1)
   - 下游客户升级为集成商
   - 集成商降级为下游客户
   - 模拟登录功能
   - 权限临时切换

6. **FE-007-06**: 前端动态界面 (P0)
   - 根据租户类型动态显示/隐藏功能
   - 智能隐藏"归属"选项
   - 自动填充字段
   - 动态菜单、表单、按钮系统

7. **FE-007-07**: 后端API服务 (P0)
   - 认证模块API（注册、登录、Token）
   - 组织管理API（CRUD、升级降级）
   - 用户管理API（CRUD、角色分配）
   - 角色管理API（CRUD、权限配置）
   - 权限验证中间件
   - 租户隔离中间件
   - API文档（Swagger/OpenAPI）

8. **FE-007-08**: 功能模块与配额管理 (P0)
   - 功能模块管理（系统默认 vs 可选）
   - 平台超管为租户开通功能
   - 集成商为下游客户分配配额
   - 配额使用统计（total, used, remaining, allocated）
   - 配额检查中间件
   - 前端动态菜单（根据功能开通情况）

9. **FE-007-09**: 系统审计日志 (P0)
   - audit_logs 表设计（JSON action_detail）
   - 日志中间件（自动记录CRUD操作）
   - 配置化日志记录（audit_log_config.yml）
   - 快速扩展新模块日志（3步流程）
   - 日志查询与导出
   - 日志保留与归档策略

#### 优先级统计
- **P0 (必须实现)**: 8个子功能
- **P1 (重要)**: 1个子功能
- **P2 (可选)**: 0个子功能

#### 技术栈
- **后端**: Golang (Go 1.21+) + Gin
- **数据库**: PostgreSQL 14+
- **缓存**: Redis 7.0+
- **认证**: JWT
- **前端**: React 18 + TypeScript + MobX + Ant Design / Material-UI
- **ORM**: GORM

## 依赖关系

### FE-007 依赖关系
- **前置依赖**: 无（云平台独立功能）

- **内部依赖**:
  - FE-007-02 依赖 FE-007-01（用户注册需要组织实体）
  - FE-007-03 依赖 FE-007-01, FE-007-02（权限需要组织和用户）
  - FE-007-04 依赖 FE-007-01（数据隔离需要managed_tenant_id字段）
  - FE-007-05 依赖 FE-007-01, FE-007-03（角色切换需要组织和权限）
  - FE-007-06 依赖 FE-007-01, FE-007-03（动态界面需要租户类型和权限）
  - FE-007-07 无依赖（后端基础功能）
  - FE-007-08 依赖 FE-007-01, FE-007-03（配额管理需要租户和权限）
  - FE-007-09 依赖 FE-007-01（日志需要租户ID）

- **后置依赖**:
  - 所有云平台业务功能（都需要账号、权限、数据隔离）

- **并行开发**:
  - FE-007-01, FE-007-02, FE-007-03 可并行开发（使用mock数据）
  - FE-007-07, FE-007-08, FE-007-09 可与所有FE并行开发（先定义API契约）

### FE-006 依赖
- **前置依赖**:
  - FE-001: Scada主页面布局功能 ✅ 已完成
  - FE-005: 自定义TitleBar实现 ✅ 已完成

- **后置依赖**:
  - 画布交互功能 (后续需求)
  - 组件拖拽功能 (后续需求)
  - 属性编辑功能 (后续需求)
  - 数据绑定功能 (后续需求)
  - 工程保存加载功能 (后续需求)

## REQ-008 详细分解

### 功能需求: FE-008
**标题**: 移动端项目初始化
**来源**: REQ-008
**平台**: APP (移动端)
**状态**: 📋 待设计

#### 核心功能
1. **项目架构搭建**
   - UniApp 项目初始化
   - 目录结构设计(modular + modular 方案)
   - 模块化架构设计
   - 路由配置和页面导航
   - 状态管理集成(Pinia)
   - 网络请求封装
   - 工具类库集成

2. **基础页面框架**
   - App.vue 主入口配置
   - pages.json 页面配置
   - manifest.json 应用配置
   - TabBar 底部导航配置
   - 页面生命周期管理
   - 全局样式配置

3. **核心模块骨架**
   - 登录模块(Auth)
   - 设备模块(Device)
   - 工作台模块(Workspace)
   - 看板模块(Dashboard)
   - 消息模块(Message)
   - 我的模块(Profile)

4. **第一个简单页面实现**
   - 启动页/欢迎页
   - 或登录页(对接云平台认证)

#### 技术栈
- **框架**: UniApp (Vue 3 + TypeScript)
- **状态管理**: Pinia
- **UI 组件库**: UniUI 或 uView
- **HTTP 客户端**: Axios 或 Uni.request 封装
- **构建工具**: Vite
- **代码规范**: ESLint + Prettier

#### 依赖关系
- **前置依赖**:
  - FE-007: 云平台账号系统(多租户认证 API) - 弱依赖,可使用 Mock

- **后置依赖**:
  - FE-009: 设备管理功能
  - FE-010: 工程管理功能
  - FE-011: 消息推送功能
  - FE-012: 数据可视化功能

- **并行开发**: 可与 FE-006, FE-007 并行开发

## REQ-009 详细分解

### 功能需求: FE-009
**标题**: 界面和组件结构优化
**来源**: REQ-009
**平台**: Scada (组态软件)
**状态**: 📋 待设计

#### 子功能列表 (10个)
1. **FE-009-01**: 应用级标签栏系统 (P0)
   - 标签栏布局组件（左侧Logo+标题，中间标签容器，右侧窗口控制）
   - 标签页组件（首页标签、工程标签）
   - 标签管理功能（创建、切换、关闭）

2. **FE-009-02**: 首页主内容区 (P0)
   - 首页布局容器（左侧导航 + 右侧内容）
   - 导航侧边栏组件（首页、本地、云端、工具）
   - 首页内容区组件（开始、最近工程）

3. **FE-009-03**: 工程编辑器主布局 (P0)
   - 编辑器布局容器（主工具栏、子工具栏、编辑区、状态栏）
   - 工具栏容器组件

4. **FE-009-04**: 工具栏交互系统 (P0)
   - 主工具栏组件（文件、编辑、视图、工具）
   - 子工具栏组件（动态内容、固定/动态模式）
   - 工具栏状态管理

5. **FE-009-05**: 编辑内容区域布局 (P0)
   - 编辑区域容器（左侧选项栏 + 右侧内容页）
   - 编辑选项栏组件（工程、画面、组件）
   - 布局配置（左侧竖向/顶部横向）

6. **FE-009-06**: 编辑内容页内部标签系统 (P0)
   - 内部标签栏组件
   - 内部标签管理（创建、切换、关闭）
   - 编辑内容主区域

7. **FE-009-07**: 组件化重构 (P0)
   - 组件库建立（应用级、布局、功能、UI组件）
   - 组件规范（接口、命名、文件组织）
   - 组件配置化

8. **FE-009-08**: 状态管理优化 (P0)
   - 标签状态管理（TabStore、SubPageTabStore）
   - 工具栏状态管理
   - 布局状态管理

9. **FE-009-09**: 样式系统统一 (P1)
   - 遵循 STYLE_GUIDE.md
   - 组件样式规范（CSS Modules）

10. **FE-009-10**: 组件及模块规范制定与文档输出 (P0) ⭐ **新增**
    - 规范文档创建（COMPONENT_STANDARDS.md）
    - 组件开发模板提供（函数组件、MobX组件、Store）
    - 规范遵循检查清单（COMPONENT_CHECKLIST.md）
    - 规范集成到开发流程（ESLint、Prettier、Git Hooks、CI/CD）
    - 已有代码重构与规范应用

#### 优先级统计
- **P0 (必须实现)**: 9个子功能
- **P1 (重要)**: 1个子功能

#### 技术栈
- **框架**: React 18.3.1 + TypeScript 5.x
- **状态管理**: MobX 6.12.0
- **桌面框架**: Electron 28
- **构建工具**: Vite 5.4.21
- **样式方案**: CSS Modules + CSS Variables

#### 依赖关系
- **前置依赖**:
  - FE-001: Scada主页面布局功能 ✅ 已完成
  - FE-005: 自定义标题栏实现 ✅ 已完成
  - FE-006: 工程编辑器整体布局与组件架构 ✅ 已完成实施计划

- **后置依赖**:
  - 工程保存与自动保存功能
  - 多工程并行编辑
  - 工程模板功能

- **并行开发**: 可与 FE-007, FE-008 并行开发

